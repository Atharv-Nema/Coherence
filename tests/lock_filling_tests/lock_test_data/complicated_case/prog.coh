/*
Complicated SCC
Looks like:

  |────▶ G
  |
Tail ──▶ A ──▶ B ──▶ C ──▶ F
        ▲           │
        │           ├──▶ D ──▶ E
        └───────────┘    ▲    │
                         └────┘

H   (isolated)
*/

func A() => unit {
    atomic { (new locked<A>[1] int(1))[0]; }
    return B();
}

func B() => unit {
    atomic { (new locked<B>[1] int(1))[0]; }
    return C();
}

func C() => unit {
    atomic { (new locked<C>[1] int(1))[0]; }
    A();        // closes triangle SCC
    D();        // enters second SCC
    F();        // fan-out
    return ();
}

func D() => unit {
    atomic { (new locked<D>[1] int(1))[0]; }
    return E();
}

func E() => unit {
    atomic { (new locked<E>[1] int(1))[0]; }
    return D();        // D <-> E SCC
}

func F() => unit {
    atomic { (new locked<F>[1] int(1))[0]; }
    return ();
}

func G() => unit {
    atomic { (new locked<G>[1] int(1))[0]; }
}

func Tail() => unit {
    atomic { (new locked<Tail>[1] int(1))[0]; }
    A();
    G();
    return ();
}

func H() => unit {
    atomic { (new locked<H>[1] int(1))[0]; }
    return ();
}

actor Main {
    new create() {}
}